<!DOCTYPE html>
<html>
<head>
<title>IPAddressChecker</title>

<script type="text/javascript">

// --- CONFIGURATION SECTION ---

// 1. JAVA Services (Running on Port 8081)
let totalValidIPURL = "http://localhost:8081/api/valid"; 

// 2. PYTHON Service (Running on Port 5001)
let classifyIPURL = "http://localhost:5001/classify"; 

// 3. PHP Service (Running on Port 7000)
let countryIPURL = "http://localhost:7000"; 

// 4. Node.js Service (Running on Port 4000)
let badIPURL = "http://localhost:4000/check-bad"

// --- DISPLAY FUNCTIONS ---

function displayTotalValid(total_valid_ips)
{
    document.getElementById('output-text').value = 'Total valid IP addresses = ' + total_valid_ips; 
}

function displayTypeofIP (type_of_ip)
{
    document.getElementById('output-text').value = "Type of IP address = " + type_of_ip;
}

function clearText()
{
    document.getElementById('input-text').value = '';
    document.getElementById('output-text').value = '';
}

// --- API CALL FUNCTIONS ---

function getTotalValidIPs(){
    let items = document.getElementById('input-text').value; 
    let xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){
            var j = JSON.parse(this.response);
            console.log('test -- ' + j.total_valid_ips);
            let total_valid_ips = j.total_valid_ips;
            displayTotalValid(total_valid_ips); 
        }
    };
    xhttp.open("GET", totalValidIPURL + "?items=" + items);
    xhttp.send(); 
}

function getClassifyIP(){
    let items = document.getElementById('input-text').value;
    let xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){
            var j = JSON.parse(this.response);
            console.log('test -- ' + j.type);
            let type_of_ip = j.type;
            displayTypeofIP(type_of_ip);
        }
    };
    xhttp.open("GET", classifyIPURL + "?ip=" + items);
    xhttp.send();
}

function findCountry(){
    let items = document.getElementById('input-text').value;
    console.log('findCountry called with IP: ' + items);
    let xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){
            var j = JSON.parse(this.response);
            let country = j.country;
            document.getElementById('output-text').value = 'Country: ' + country;
        }
    };
    xhttp.open("GET", countryIPURL + "?ip=" + items);
    xhttp.send();
}

function findBadIPs() {
    let items = document.getElementById('input-text').value;
    let xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){
            var j = JSON.parse(this.response);
            let result = j.result;
            document.getElementById('output-text').value = 'Result: ' + result;
        }
    };
    xhttp.open("GET", badIPURL + "?ip=" + items);
    xhttp.send();
}

</script>

<style type="text/css">
body  {
    font-size: 150%;
    font-family: monospace;
}
label {
    display: inline-block;
    width: 150px;
    text-align: left;
}
#logo
{
    font-family: Calibri, sans-serif;
    font-weight: lighter;
    font-size: 30px;
    color: #505050;
    margin: 0.5em;
}
#normal-text
{
    font-family: Calibri, sans-serif;
    font-size: 20px;
    margin: 0.5em;
}
#ipcheck
{
    text-align: center;
    margin-top: 1em;
}
#input-div
{
    text-align: center;
    margin-top: 1em;
    background-color:#d5d8dc  ;
}
#output-div
{
    text-align: center;
    background-color:#808b96 ;
}

.input-items {
      font-size: 90%;
      color: black;
      background-color:white ;
      padding: 0.2em;
      margin: 0.2em;
      font-family: monospace;
      letter-spacing: 0.1em;
      width: 600px;
}

.display-output {
    font-size: 90%;
    color: black;
    background-color:white ;
    padding: 0.2em;
    margin: 0.2em;
    font-family: monospace;
    letter-spacing: 0.1em;
    width: 600px;
}

.button-active {
    background-color:   #2874a6  ;
    color: white;
    padding: 0px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 18px;
    margin: 4px 2px;
    cursor: pointer;
    height: 50px;
    width: 400px;
}

.button-inactive {
    background-color: gray;
    color: white;
    padding: 0px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 18px;
    margin: 4px 2px;
    cursor: pointer;
    height: 50px;
    width: 400px;
}

.button-clear {
    background-color:  #c0392b ;
    color: white;
    padding: 0px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 18px;
    margin: 4px 2px;
    cursor: pointer;
    height: 40px;
    width: 400px;
}

</style>

</head>
<body>
<div id="ipcheck">
    <div id="logo">
        IP Address Checker
    </div>
    <div id="input-div">
        <p id="normal-text">
          Paste your IP addresses here (separated by commas)..
        </p>
        <textarea class="input-items" id="input-text" rows="5" cols="35" placeholder="Paste your IP addresses here.." value="">
        </textarea>
    </div>
    <div id="output-div">
       <p id="normal-text">
          Results
        </p>
        <textarea class="display-output" id="output-text" rows="5" cols="35" readonly=1 placeholder="Results here..." value="">
        </textarea>
    </div>
    <div>
        <button class="button-inactive" onclick="getTotalValidIPs();">Total valid IP addresses</button>
    </div>
    <div>
        <button class="button-inactive" onclick="getClassifyIP();">Classify between IPv4 and IPv6</button>
    </div>
    <div>
       <button type="button" class="button-inactive" onclick="findCountry()">Find country information</button>
    </div>
    <div>
        <button class="button-inactive" onclick="findBadIPs();">Find bad IP addresses</button>
    </div>
    <div>
        <button class="button-clear" onclick="clearText();">Clear</button>
    </div>

</div>
</body>
</html>
